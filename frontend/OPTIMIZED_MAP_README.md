# –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∏–∫—Å–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ (PixMap.fun –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∏–∫—Å–µ–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π PixMap.fun.

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —á–∞–Ω–∫–æ–≤** - –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–π–ª–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—è–º –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
- **Offscreen —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** - –ø–ª–∞–≤–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI
- **Throttled —Å–æ–±—ã—Ç–∏—è** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- **Chunk-based –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —É–º–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é –¥–æ 200 —á–∞–Ω–∫–æ–≤
- **Spatial indexing** - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –≤–∏–¥–∏–º—ã—Ö –æ–±–ª–∞—Å—Ç–µ–π

### üé® –í–∏–∑—É–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- **–ü–ª–∞–≤–Ω—ã–π –∑—É–º** - –æ—Ç 0.125x –¥–æ 16x –±–µ–∑ —Ä—ã–≤–∫–æ–≤
- **Pixelated —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥** - —á–µ—Ç–∫–∏–µ –ø–∏–∫—Å–µ–ª–∏ –ø—Ä–∏ –±–æ–ª—å—à–∏—Ö —É–≤–µ–ª–∏—á–µ–Ω–∏—è—Ö
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–µ—Ç–∫–∞** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑—É–º–µ > 4x
- **–ú–∏–Ω–∏-–∫–∞—Ä—Ç–∞** - –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UI** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è

### üì± –ú–æ–±–∏–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- **Multi-touch –∑—É–º** - pinch-to-zoom –∂–µ—Å—Ç—ã
- **–ü–ª–∞–≤–Ω–∞—è –ø–∞–Ω–æ—Ä–∞–º–∞** - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è touch —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–î–≤–æ–π–Ω–æ–π —Ç–∞–ø –∑—É–º** - –±—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
- **Haptic feedback** - —Ç–∞–∫—Ç–∏–ª—å–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```
‚îú‚îÄ‚îÄ OptimizedPixelMap.tsx    - –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞—Ä—Ç—ã
‚îú‚îÄ‚îÄ ChunkSystem.ts           - –°–∏—Å—Ç–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞–Ω–∫–æ–≤
‚îú‚îÄ‚îÄ OffscreenRenderer.ts     - Offscreen —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ mapStore.ts              - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞—Ä—Ç—ã
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

#### ChunkSystem
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–º–∏ —á–∞–Ω–∫–∞–º–∏ 256x256
- –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –æ–∫—Ä—É–∂–∞—é—â–∏—Ö –æ–±–ª–∞—Å—Ç–µ–π
- LRU –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 5 —É—Ä–æ–≤–Ω–µ–π LOD

#### OffscreenRenderer
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ/canvas
- –î–≤–æ–π–Ω–∞—è –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è
- Throttling –¥–æ 60 FPS
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

#### MapStore (Zustand)
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ viewport
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤–≤–æ–¥–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```tsx
import { OptimizedPixelMap } from './components/Map/OptimizedPixelMap';

function App() {
  const handlePixelPlaced = (x: number, y: number, color: string) => {
    console.log(`Pixel at (${x}, ${y}) with color ${color}`);
  };

  return (
    <OptimizedPixelMap 
      onPixelPlaced={handlePixelPlaced}
      showDebugInfo={true}
    />
  );
}
```

### –° —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º GameStore
```tsx
import { GameWorldMap } from './components/Map/GameWorldMap';

// GameWorldMap —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OptimizedPixelMap –≤–Ω—É—Ç—Ä–∏
function GameApp() {
  return <GameWorldMap />;
}
```

### –î–µ–º–æ –≤–µ—Ä—Å–∏—è
```bash
# –ó–∞–ø—É—Å–∫ –¥–µ–º–æ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
npm run dev

# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–∏–ª–¥ –¥–ª—è –¥–µ–º–æ
# (–¥–æ–±–∞–≤—å—Ç–µ –≤ package.json)
"demo": "vite --config vite.demo.config.ts"
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### MapSettings –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```typescript
interface MapSettings {
  showGrid: boolean;                // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–µ—Ç–∫—É –ø—Ä–∏ –∑—É–º–µ
  showChunkBorders: boolean;        // Debug: –≥—Ä–∞–Ω–∏—Ü—ã —á–∞–Ω–∫–æ–≤
  enableSmoothScrolling: boolean;   // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
  pixelatedRendering: boolean;      // Pixelated —Ä–µ–∂–∏–º
  preloadDistance: number;          // –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ (–≤ —á–∞–Ω–∫–∞—Ö)
  maxCacheSize: number;             // –ú–∞–∫—Å–∏–º—É–º —á–∞–Ω–∫–æ–≤ –≤ –∫–µ—à–µ
}
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```typescript
interface RenderPerformance {
  fps: number;           // –¢–µ–∫—É—â–∏–π FPS
  frameTime: number;     // –í—Ä–µ–º—è –∫–∞–¥—Ä–∞ –≤ –º—Å
  chunksLoaded: number;  // –ó–∞–≥—Ä—É–∂–µ–Ω–æ —á–∞–Ω–∫–æ–≤
  chunksVisible: number; // –í–∏–¥–∏–º–æ —á–∞–Ω–∫–æ–≤
  memoryUsage: number;   // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
}
```

## üéØ API

### OptimizedPixelMap Props
```typescript
interface Props {
  className?: string;
  onPixelPlaced?: (x: number, y: number, color: string) => void;
  showDebugInfo?: boolean;
}
```

### MapStore –º–µ—Ç–æ–¥—ã
```typescript
// Viewport —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
setViewport(viewport: Partial<MapViewport>): void;
handleWheel(deltaY: number, centerX: number, centerY: number): void;
handlePan(deltaX: number, deltaY: number): void;

// –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
screenToWorld(screenX: number, screenY: number): {x, y};
worldToScreen(worldX: number, worldY: number): {x, y};

// –ü–∏–∫—Å–µ–ª–∏
placePixel(x: number, y: number, color: string): void;
invalidateRegion(x: number, y: number, width?, height?): void;
```

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Spatial culling** - —Ä–µ–Ω–¥–µ—Ä —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã—Ö —á–∞–Ω–∫–æ–≤
- **LOD —Å–∏—Å—Ç–µ–º–∞** - –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é –∑—É–º–∞
- **Request batching** - –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∑–∞–≥—Ä—É–∑–æ–∫
- **Memory pooling** - –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
- **Event throttling** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

### –ú–µ—Ç—Ä–∏–∫–∏
- 60+ FPS –ø—Ä–∏ –ª—é–±–æ–º –∑—É–º–µ
- < 100–º—Å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞–Ω–∫–∞
- < 200MB –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Ä—Ç –¥–æ 16384x16384 –ø–∏–∫—Å–µ–ª–µ–π

## üîß –û—Ç–ª–∞–¥–∫–∞

### Debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–í–∫–ª—é—á–∏—Ç–µ `showDebugInfo={true}` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:
- –¢–µ–∫—É—â–∏–π –∑—É–º –∏ –ø–æ–∑–∏—Ü–∏—è
- FPS –∏ –≤—Ä–µ–º—è –∫–∞–¥—Ä–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö/–≤–∏–¥–∏–º—ã—Ö —á–∞–Ω–∫–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫—É—Ä—Å–æ—Ä–∞

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏
```javascript
// –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
localStorage.setItem('MAP_DEBUG', 'true');

// –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞–Ω–∫–æ–≤
console.log(useMapStore.getState().performance);

// –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–µ—à–∞
console.log(chunkSystem.getStats());
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –° –±–µ–∫–µ–Ω–¥–æ–º
```typescript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
const handlePixelPlaced = async (x, y, color) => {
  try {
    await gameAPI.placeTap(selectedCountry.id, x, y);
  } catch (error) {
    console.error('Pixel placement failed:', error);
  }
};

// WebSocket –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
wsService.on('pixel_update', (data) => {
  mapStore.getState().invalidateRegion(data.x, data.y);
});
```

### –° —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ** —Å —Ç–µ–∫—É—â–∏–º GameStore
- **–ó–∞–º–µ–Ω—è–µ—Ç** —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É canvas —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
- **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç** –≤—Å–µ –∏–≥—Ä–æ–≤—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏
- **–£–ª—É—á—à–∞–µ—Ç** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è API

## üìà –ú–∏–≥—Ä–∞—Ü–∏—è

### –ó–∞–º–µ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–∞—Ä—Ç—ã
1. –ó–∞–º–µ–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∫–∞—Ä—Ç—ã
2. –û–±–Ω–æ–≤–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –í—Å–µ props –∏ callbacks –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ
- GameStore –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π  
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–ª–∞–≤–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö** üöÄ